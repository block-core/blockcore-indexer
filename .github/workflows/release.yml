name: Release

on:
  release:
    types: [published, prereleased, edited]

jobs:
  build:
    name: Build and Push Image 2
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@master

      - name: deploy
        run: |
          echo "action - ${{ github.event.action }}"
          echo "url - ${{ github.event.release.url }}"
          echo "assets_url - ${{ github.event.release.assets_url }}"
          echo "id - ${{ github.event.release.id }}"
          echo "tag_name - ${{ github.event.release.tag_name }}"
          echo "assets - ${{ github.event.assets }}"
          echo "assets[0] - ${{ github.event.assets[0] }}"

      - name: Find and Replace
        uses: jacobtomlinson/gha-find-replace@master
        with:
          find: "${{version}}"
          replace: "${{ github.event.release.tag_name }}"
          include: "src/Blockcore.Indexer/Dockerfile"

      # - name: Build the Docker container image
      #   run: docker build -f "./src/Blockcore.Indexer/Dockerfile" -t docker.pkg.github.com/block-core/blockcore-indexer/blockcoreindexer:latest --label "unstable=true" "."

      # - name: Login and Push to GitHub Docker Registry
      #   run: |
      #     docker login docker.pkg.github.com -u "blockcore-indexer" -p "${{secrets.GITHUB_TOKEN}}"
      #     docker push docker.pkg.github.com/block-core/blockcore-indexer/blockcoreindexer:latest
